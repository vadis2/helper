#### Doctrine\DBAL\Driver\PDOException: SQLSTATE[23000]: Integrity constraint violation: 1217 Cannot delete or update a parent row: a foreign key constraint fails
Add to tearDown deleting of all pivot tables:
````
public function tearDown()
    : void
    {
        parent::tearDown(); // TODO: Change the autogenerated stub

        Schema::dropIfExists('user_roles');
        Schema::dropIfExists('method_roles');
        Schema::dropIfExists('roles');
        Schema::dropIfExists('users');
    }
````
#### Too many connections
Add in config database.php (testing):
````
'options'   => array(
    PDO::ATTR_PERSISTENT => env('DB_PERSISTENT', true),
),
````
It will be looked like:
````
'testing' => [
            'driver'    => 'mysql',
            'host'      => env('DB_HOST', '127.0.0.1'),
            'port'      => env('DB_PORT', '3306'),
            'database'  => env('DB_DATABASE', 'forge'),
            'username'  => env('DB_USERNAME', 'forge'),
            'password'  => env('DB_PASSWORD', ''),
            'options'   => array(
                PDO::ATTR_PERSISTENT => env('DB_PERSISTENT', true),
            ),
            'charset'   => 'utf8mb4',
            'collation' => 'utf8mb4_unicode_ci',
            'prefix'    => '',
            'strict'    => true,
            'engine'    => null,
        ],

````
#### Illuminate\Database\QueryException: SQLSTATE[23000]: Integrity constraint violation: 1217 Cannot delete or update a parent row: a foreign key constraint fails (SQL: drop table if exists `customers`)
Check WnyTestCase.php tearDown. Maybe new DB table is not dropped?

#### 302, API, Test
````
✘ Store a wrong data for admin
        ┐
        ├ Expected status code 422 but received 302. 
````
Solution: add header
````
$response = $this->withHeader('Accept', 'application/json')
            ->post('api/v1/users?token=' . $token, $data);
````

#### phpUnit 9
Change in phpunit.xml:
````
<!--
<filter>
    <whitelist processUncoveredFilesFromWhitelist="true">
        <directory suffix=".php">./app</directory>
    </whitelist>
</filter>
-->
<coverage processUncoveredFiles="true">
    <include>
        <directory suffix=".php">./app</directory>
    </include>
</coverage>
````

        
